<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Cilk (Gforth マニュアル)</title>

<meta name="description" content="Cilk (Gforth マニュアル)">
<meta name="keywords" content="Cilk (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Multitasker.html" rel="up" title="Multitasker">
<link href="Pthreads.html" rel="prev" title="Pthreads">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="subsection" id="Cilk">
<div class="header">
<p>
Previous: <a href="Pthreads.html" accesskey="p" rel="prev">Pthreads</a>, Up: <a href="Multitasker.html" accesskey="u" rel="up">Multitasker</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Cilk-1"></span><h4 class="subsection">6.27.2 Cilk</h4>

<p>Gforth&rsquo;s Cilk is a framework for dividing work between multiple tasks
running on several cores, inspired by the programming language of the same
name.  Use <code>require cilk.fs</code> if you want to use Cilk.
</p>
<p>The idea is that you identify subproblems that can be solved in parallel,
and the framework assigns worker tasks to these subproblems.  In particular,
you use one of the <code>spawn</code> words for each subtask.  Eventually you need
to wait with <code>cilk-sync</code> for the subproblems to be solved.
</p>
<p>Currently all the spawning has to happen from one task, and <code>cilk-sync</code>
waits for all subproblems to complete, so using the current Gforth Cilk for
recursive algorithms is not straightforward.
</p>
<p>Do not divide the subproblems too finely, in order to avoid overhead; how
fine is too fine depends on how uniform the run-time for the subproblems is,
but for problems with substantial run-time, having 5*<code>cores</code>
subproblems is probably a good starting point.
</p>
<span id="index-cores-_0028--_002d_002d-u--_0029-cilk"></span>
<span id="index-cores"></span>
<span id="index-cores-1"></span>
<div class="format">
<pre class="format"><code>cores</code> ( <i>&ndash; u  </i>) cilk &ldquo;cores&rdquo;
</pre></div>
<p>A value containing the number of worker tasks to use.  By default this is
the number of hardware threads (with SMT/HT), if we can determine that,
otherwise 1.  If you want to use a different number, change <code>cores</code>
before calling <code>cilk-init</code>.
</p>

<span id="index-cilk_002dinit-_0028--_002d_002d--_0029-cilk"></span>
<span id="index-cilk_002dinit"></span>
<span id="index-cilk_002dinit-1"></span>
<div class="format">
<pre class="format"><code>cilk-init</code> ( <i>&ndash;  </i>) cilk &ldquo;cilk-init&rdquo;
</pre></div>
<p>Start the worker tasks if not already done.
</p>

<span id="index-spawn-_0028--xt-_002d_002d--_0029-cilk"></span>
<span id="index-spawn"></span>
<span id="index-spawn-1"></span>
<div class="format">
<pre class="format"><code>spawn</code> ( <i>xt &ndash;  </i>) cilk &ldquo;spawn&rdquo;
</pre></div>
<p>Execute <i>xt</i> ( &ndash; ) in a worker task.  Use one-time executable closures to
pass heap-allocated closures, allowing to pass arbitrary data from the
spawner to the code running in the worker.<br> E.g.: <code>( n r ) [{: n f: r
:}h1 code ;] spawn</code>
</p>

<span id="index-spawn1-_0028--x-xt-_002d_002d--_0029-cilk"></span>
<span id="index-spawn1"></span>
<span id="index-spawn1-1"></span>
<div class="format">
<pre class="format"><code>spawn1</code> ( <i>x xt &ndash;  </i>) cilk &ldquo;spawn1&rdquo;
</pre></div>
<p>Execute <i>xt</i> ( x &ndash; ) in a worker task.
</p>

<span id="index-spawn2-_0028--x1-x2-xt-_002d_002d--_0029-cilk"></span>
<span id="index-spawn2"></span>
<span id="index-spawn2-1"></span>
<div class="format">
<pre class="format"><code>spawn2</code> ( <i>x1 x2 xt &ndash;  </i>) cilk &ldquo;spawn2&rdquo;
</pre></div>
<p>Execute <i>xt</i> ( x1 x2 &ndash; ) in a worker task.
</p>

<span id="index-cilk_002dsync-_0028--_002d_002d--_0029-cilk"></span>
<span id="index-cilk_002dsync"></span>
<span id="index-cilk_002dsync-1"></span>
<div class="format">
<pre class="format"><code>cilk-sync</code> ( <i>&ndash;  </i>) cilk &ldquo;cilk-sync&rdquo;
</pre></div>
<p>Wait for all subproblems to complete.
</p>

<span id="index-cilk_002dbye-_0028--_002d_002d--_0029-cilk"></span>
<span id="index-cilk_002dbye"></span>
<span id="index-cilk_002dbye-1"></span>
<div class="format">
<pre class="format"><code>cilk-bye</code> ( <i>&ndash;  </i>) cilk &ldquo;cilk-bye&rdquo;
</pre></div>
<p>Terminate all workers.
</p>


</div>
<hr>
<div class="header">
<p>
Previous: <a href="Pthreads.html">Pthreads</a>, Up: <a href="Multitasker.html">Multitasker</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
