<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Constants (Gforth マニュアル)</title>

<meta name="description" content="Constants (Gforth マニュアル)">
<meta name="keywords" content="Constants (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Defining-Words.html" rel="up" title="Defining Words">
<link href="Values.html" rel="next" title="Values">
<link href="Variables.html" rel="prev" title="Variables">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="subsection" id="Constants">
<div class="header">
<p>
Next: <a href="Values.html" accesskey="n" rel="next">Values</a>, Previous: <a href="Variables.html" accesskey="p" rel="prev">Variables</a>, Up: <a href="Defining-Words.html" accesskey="u" rel="up">Defining Words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Constants-1"></span><h4 class="subsection">6.10.3 Constants</h4>
<span id="index-constants"></span>

<p><code>constant</code> を使用すると、 固定値を宣言し、 名前でそれを参照できます。 例:
</p>
<div class="example">
<pre class="example">12 Constant INCHES-PER-FOOT
3E+08 fconstant SPEED-O-LIGHT
</pre></div>

<p><code>Variable</code> は読み取りと書き込みの両方ができるため、 その実行時の振る舞いは、 現在の値を操作できるアドレスを提供することです。
それとは対照的に、 <code>Constant</code> の値は一度宣言すると変更できないため、 アドレスを指定する必要はありません<a id="DOCF14" href="#FOOT14"><sup>14</sup></a>
&ndash; 定数の値を直接返す方が効率的です。 そして正にそのとおりになります。 つまり、
定数の実行時の効果は、その値をスタックの頂上に置くことです((<code>Constant</code> を実装する方法の1つは <a href="User_002ddefined-Defining-Words.html">User-defined Defining Words</a> で見つけることができます)。
</p>
<p>Forth は、それぞれ2倍長定数と浮動小数点定数を定義するための <code>2Constant</code> と <code>fconstant</code>
も提供します。
</p>
<span id="index-Constant-_0028--w-_0022name_0022-_002d_002d--_0029-core"></span>
<span id="index-Constant"></span>
<span id="index-Constant-1"></span>
<div class="format">
<pre class="format"><code>Constant</code> ( <i>w &quot;name&quot; &ndash;  </i>) core &ldquo;Constant&rdquo;
</pre></div>
<p>定数 <i>name</i> を値 <i>w</i> で定義します。
</p> 
<p><i>name</i> 実行時: <i>&ndash; w</i>
</p>

<span id="index-AConstant-_0028--addr-_0022name_0022-_002d_002d--_0029-gforth_002d0_002e2"></span>
<span id="index-AConstant"></span>
<span id="index-AConstant-1"></span>
<div class="format">
<pre class="format"><code>AConstant</code> ( <i>addr &quot;name&quot; &ndash;  </i>) gforth-0.2 &ldquo;AConstant&rdquo;
</pre></div>
<p><code>constant</code> と似ていますが、 アドレスのための定数を定義します(これはクロス・コンパイラーでのみ違いが生じます)。
</p>

<span id="index-2Constant-_0028--w1-w2-_0022name_0022-_002d_002d--_0029-double"></span>
<span id="index-2Constant"></span>
<span id="index-2Constant-1"></span>
<div class="format">
<pre class="format"><code>2Constant</code> ( <i>w1 w2 &quot;name&quot; &ndash;  </i>) double &ldquo;two-constant&rdquo;
</pre></div>

<span id="index-fconstant-_0028--r-_0022name_0022-_002d_002d--_0029-floating"></span>
<span id="index-fconstant"></span>
<span id="index-fconstant-1"></span>
<div class="format">
<pre class="format"><code>fconstant</code> ( <i>r &quot;name&quot; &ndash;  </i>) floating &ldquo;f-constant&rdquo;
</pre></div>






<p>Forth の定数は、他のプログラミング言語の定数とは異なる振る舞いをします。 他の言語では、 定数(アセンブラの EQU や C の #define
など)はコンパイル時にのみ存在します。 実行プログラム(executable program)では、 定数は即値(absolute
number)に変換されているため、 シンボリック・デバッガを使用しない限り、 その数値がどのような抽象的なものを表しているかを知ることは不可能です。
Forth では、 定数はヘッダー空間にエントリを持ち、 それを使用するコードが定義された後もそこに残ります。 実際、 実行時に機能する義務があるため、
それをディクショナリに残しておく必要があります。 例:
</p>
<div class="example">
<pre class="example">12 Constant INCHES-PER-FOOT
: FEET-TO-INCHES ( n1 -- n2 ) INCHES-PER-FOOT * ;
</pre></div>

<span id="index-in_002dlining-of-constants"></span>
<p>ここで、 <code>FEET-TO-INCHES</code> が実行されると、 定数 <code>INCHES-PER-FOOT</code> に関連付けられた xt
が実行されます。 <code>see</code> を使用して <code>FEET-TO-INCHES</code> の定義を逆コンパイルすると、
<code>INCHES-PER-FOOT</code> を呼び出していることがわかります。 一部の Forth
コンパイラは、定数を使用する場所にインライン展開(in-lining)することによって定数を最適化しようとします。 以下のようにして Gforth
に定数をインライン化するように強制できます:
</p>
<div class="example">
<pre class="example">: FEET-TO-INCHES ( n1 -- n2 ) [ INCHES-PER-FOOT ] LITERAL * ;
</pre></div>

<p>ここで、 <code>see</code> を使用して <code>FEET-TO-INCHES</code> の このバージョンを逆コンパイルすると、
<code>INCHES-PER-FOOT</code> が存在しないことがわかります。 これがどのように機能するかを理解するには、
<a href="Interpret_002fCompile-states.html">Interpret/Compile states</a> と <a href="Literals.html">Literals</a> を読んでください。
</p>
<p>この方法で定数をインライン化すると、 実行時間がわずかに改善される可能性があり、 定数がコンパイル時にのみ参照されるようにすることができます。 ただし、
定数の定義はまだディクショナリに残っています。 一部の Forth コンパイラは、 一時的なワード(transient words)を保持する 2
番目のディクショナリを制御するメカニズムを提供し、 メモリ領域を回復するために後でこの 2 番目のディクショナリを削除できるようしています。 ただし、
これを行う標準の方法はありません。
</p>

</div>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5><a id="FOOT14" href="#DOCF14">(14)</a></h5>
<p>まあ、
多くの場合、 それは可能ではありますが、 標準的な移植可能な方法では変更できません。 <code>Value</code> を使用する方が安全です
(続きを読んでください)まあ、多くの場合変更できますが、標準的な移植可能な方法では変更できません。 <code>Value</code> (続きを読んでください)</p>
</div>



</body>
</html>
