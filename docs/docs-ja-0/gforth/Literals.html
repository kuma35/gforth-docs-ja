<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Literals (Gforth マニュアル)</title>

<meta name="description" content="Literals (Gforth マニュアル)">
<meta name="keywords" content="Literals (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Compiling-words.html" rel="up" title="Compiling words">
<link href="Macros.html" rel="next" title="Macros">
<link href="Compiling-words.html" rel="prev" title="Compiling words">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="subsection" id="Literals">
<div class="header">
<p>
Next: <a href="Macros.html" accesskey="n" rel="next">Macros</a>, Previous: <a href="Compiling-words.html" accesskey="p" rel="prev">Compiling words</a>, Up: <a href="Compiling-words.html" accesskey="u" rel="up">Compiling words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Literals-1"></span><h4 class="subsection">6.13.1 Literals</h4>
<span id="index-Literals"></span>

<p>最も単純で最も頻繁に使用される例は、 コンパイル中にリテラルを計算することです。  たとえば、 以下の定義は、 文字列の配列を 1 行に 1
つの文字列で出力します:
</p>
<div class="example">
<pre class="example">: .strings ( addr u -- ) \ gforth
    2* cells bounds U+DO
        cr i 2@ type
    2 cells +LOOP ;  
</pre></div>

<p>Gforth のような愚かで低能なコンパイラを使用すると、 ループ反復ごとに <code>2 cells</code> が計算されます。  あなたは、
この値をコンパイル時に一度だけ計算し、 定義にコンパイルできます。 以下のようにします:
</p>
<div class="example">
<pre class="example">: .strings ( addr u -- ) \ gforth
    2* cells bounds U+DO
        cr i 2@ type
    [ 2 cells ] literal +LOOP ;  
</pre></div>

<p><code>[</code> は、 テキスト・インタープリタをインタプリタ状態に切り替えます(この例を対話的に入力し、 <code>[</code> と <code>]</code>
の間に改行を挿入すると、 <code>ok</code> プロンプトが表示されます)。 <code>2 cells</code>
のインタプリタ機能(interpretation semantics)を実行します。 ここでは数値を計算します。  <code>]</code> は、
テキスト・インタプリタをコンパイル状態に戻します。  次に、 この数値を現在のワードにコンパイルする <code>Literal</code>
のコンパイル機能(compilation semantics)を実行します。 <code>see .strings</code>
を使用してワードを逆コンパイルすると、 コンパイルされたコードへの影響を確認できます。
</p>
<p>この方法で <code>2* cells</code> を <code>[ 2 cells ] literal *</code>  に最適化することもできます。
</p>
<span id="index-_005b-_0028--_002d_002d--_0029-core"></span>
<span id="index-_005b"></span>
<span id="index-_005b-1"></span>
<div class="format">
<pre class="format"><code>[</code> ( <i>&ndash;  </i>) core &ldquo;left-bracket&rdquo;
</pre></div>
<p>インタプリタ状態にします。 即実行ワードです。
</p>

<span id="index-_005d-_0028--_002d_002d--_0029-core"></span>
<span id="index-_005d"></span>
<span id="index-_005d-1"></span>
<div class="format">
<pre class="format"><code>]</code> ( <i>&ndash;  </i>) core &ldquo;right-bracket&rdquo;
</pre></div>
<p>コンパイル状態にします。
</p>

<span id="index-Literal-_0028--compilation-n-_002d_002d-_003b-run_002dtime-_002d_002d-n--_0029-core"></span>
<span id="index-Literal"></span>
<span id="index-Literal-1"></span>
<div class="format">
<pre class="format"><code>Literal</code> ( <i>compilation n &ndash; ; run-time &ndash; n  </i>) core &ldquo;Literal&rdquo;
</pre></div>
<p>コンパイル機能(compilation semantics): 実行機能(run-time semantics)をコンパイルします。
実行機能(run-time semantics): <i>n</i> をスタックにプッシュします。 インタプリタ機能(interpretation
semantics): 未定義です。
</p>

<span id="index-ALiteral-_0028--compilation-addr-_002d_002d-_003b-run_002dtime-_002d_002d-addr--_0029-gforth_002d0_002e2"></span>
<span id="index-ALiteral"></span>
<span id="index-ALiteral-1"></span>
<div class="format">
<pre class="format"><code>ALiteral</code> ( <i>compilation addr &ndash; ; run-time &ndash; addr  </i>) gforth-0.2 &ldquo;ALiteral&rdquo;
</pre></div>
<p><code>literal</code> と同様に機能しますが、
(クロス・コンパイルされたコードで使用される場合、)リテラルがアドレスであることをクロス・コンパイラーに伝えます。
</p>

<span id="index-_005dL-_0028--compilation_003a-n-_002d_002d-_003b-run_002dtime_003a-_002d_002d-n--_0029-gforth_002d0_002e5"></span>
<span id="index-_005dL"></span>
<span id="index-_005dL-1"></span>
<div class="format">
<pre class="format"><code>]L</code> ( <i>compilation: n &ndash; ; run-time: &ndash; n  </i>) gforth-0.5 &ldquo;]L&rdquo;
</pre></div>
<p><code>] literal</code> と同等。
</p>


<p>単一セル以外のデータ型をリテラルとしてコンパイルするためのワードもあります:
</p>
<span id="index-2Literal-_0028--compilation-w1-w2-_002d_002d-_003b-run_002dtime-_002d_002d-w1-w2--_0029-double"></span>
<span id="index-2Literal"></span>
<span id="index-2Literal-1"></span>
<div class="format">
<pre class="format"><code>2Literal</code> ( <i>compilation w1 w2 &ndash; ; run-time  &ndash; w1 w2  </i>) double &ldquo;two-literal&rdquo;
</pre></div>
<p>実行時に <i>w1 w2</i> がスタックに配置されるように、 適切なコードをコンパイルします。 インタプリタ機能(interpretation
semantics)は未定義です。
</p>

<span id="index-FLiteral-_0028--compilation-r-_002d_002d-_003b-run_002dtime-_002d_002d-r--_0029-floating"></span>
<span id="index-FLiteral"></span>
<span id="index-FLiteral-1"></span>
<div class="format">
<pre class="format"><code>FLiteral</code> ( <i>compilation r &ndash; ; run-time &ndash; r  </i>) floating &ldquo;f-literal&rdquo;
</pre></div>
<p>実行時に <i>r</i> が(浮動小数点)スタックに配置されるように、 適切なコードをコンパイルします。 インタプリタ機能(interpretation
semantics)は未定義です。
</p>

<span id="index-SLiteral-_0028--Compilation-c_002daddr1-u-_003b-run_002dtime-_002d_002d-c_002daddr2-u--_0029-string"></span>
<span id="index-SLiteral"></span>
<span id="index-SLiteral-1"></span>
<div class="format">
<pre class="format"><code>SLiteral</code> ( <i>Compilation c-addr1 u ; run-time &ndash; c-addr2 u  </i>) string &ldquo;SLiteral&rdquo;
</pre></div>
<p>コンパイル時: <i>c-addr1</i>, <i>u</i> で指定された文字列を現在の定義にコンパイルします。 実行時: 文字列のアドレスと長さを記述する
<i>c-addr2 u</i> を返します。
</p>


<span id="index-colon_002dsys_002c-passing-data-across-_003a"></span>
<span id="index-_003a_002c-passing-data-across"></span>
<p>データ・スタック上のコロン定義の外側から内側にデータを渡したいと思うかもしれません。  <code>:</code> がコロン colon-sys をプッシュし、
colon-sys より下のモノのにアクセスできなくなるため、 これは機能しません。  たとえば、 以下は機能しません:
</p>
<div class="example">
<pre class="example">5 : foo literal ; \ error: &quot;unstructured&quot;
</pre></div>

<p>代わりに、 変数など、 他の方法で値を渡す必要があります:
</p>
<div class="example">
<pre class="example">variable temp
5 temp !
: foo [ temp @ ] literal ;
</pre></div>


</div>
<hr>
<div class="header">
<p>
Next: <a href="Macros.html">Macros</a>, Previous: <a href="Compiling-words.html">Compiling words</a>, Up: <a href="Compiling-words.html">Compiling words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
