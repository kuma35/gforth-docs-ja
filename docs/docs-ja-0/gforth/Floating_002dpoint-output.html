<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright © 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Floating-point output (Gforth マニュアル)</title>

<meta name="description" content="Floating-point output (Gforth マニュアル)">
<meta name="keywords" content="Floating-point output (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Other-I_002fO.html" rel="up" title="Other I/O">
<link href="Miscellaneous-output.html" rel="next" title="Miscellaneous output">
<link href="Formatted-numeric-output.html" rel="prev" title="Formatted numeric output">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
pre.format-preformatted {font-family: inherit}
span:hover a.copiable-link {visibility: visible}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="subsection-level-extent" id="Floating_002dpoint-output">
<div class="nav-panel">
<p>
Next: <a href="Miscellaneous-output.html" accesskey="n" rel="next">Miscellaneous output</a>, Previous: <a href="Formatted-numeric-output.html" accesskey="p" rel="prev">Formatted numeric output</a>, Up: <a href="Other-I_002fO.html" accesskey="u" rel="up">Other I/O</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsection" id="Floating_002dpoint-output-1"><span>6.20.3 Floating-point output<a class="copiable-link" href="#Floating_002dpoint-output-1"> &para;</a></span></h4>
<a class="index-entry-id" id="index-numeric-output_002c-FP"></a>
<a class="index-entry-id" id="index-FP-output"></a>
<a class="index-entry-id" id="index-floating_002dpoint-output"></a>

<p>浮動小数点数出力は常に基数 10 を使用して表示されます。
</p>
<a class="index-entry-id" id="index-f_002e-_0028-r-_002d_002d-_0029-floating_002dext"></a>
<a class="index-entry-id" id="index-f_002e"></a>
<a class="index-entry-id" id="index-f_002e-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">f.</code> ( <i class="i">r &ndash;  </i>) floating-ext &ldquo;f-dot&rdquo;
</pre></div>
<p>(浮動小数点数) <i class="i">r</i> を指数なしで表示し、 その後に空白1つ続けます。
</p>

<a class="index-entry-id" id="index-fe_002e-_0028-r-_002d_002d-_0029-floating_002dext"></a>
<a class="index-entry-id" id="index-fe_002e"></a>
<a class="index-entry-id" id="index-fe_002e-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">fe.</code> ( <i class="i">r &ndash;  </i>) floating-ext &ldquo;f-e-dot&rdquo;
</pre></div>
<p><i class="i">r</i> を工学表記(3 で割り切れる指数) で表示し、 その後に空白1つ続けます。
</p>

<a class="index-entry-id" id="index-fs_002e-_0028-r-_002d_002d-_0029-floating_002dext"></a>
<a class="index-entry-id" id="index-fs_002e"></a>
<a class="index-entry-id" id="index-fs_002e-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">fs.</code> ( <i class="i">r &ndash;  </i>) floating-ext &ldquo;f-s-dot&rdquo;
</pre></div>
<p><i class="i">r</i> を科学表記(指数付き)で表示し、 その後に空白1つ続けます。
</p>

<a class="index-entry-id" id="index-fp_002e-_0028-r-_002d_002d-_0029-floating_002dext"></a>
<a class="index-entry-id" id="index-fp_002e"></a>
<a class="index-entry-id" id="index-fp_002e-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">fp.</code> ( <i class="i">r &ndash;  </i>) floating-ext &ldquo;f-p-dot&rdquo;
</pre></div>
<p><i class="i">r</i> を SI 接頭辞表記(3 で割れる指数を使用し、 可能な場合は SI 接頭辞に変換)で表示し、 その後に空白1つ続けます。
</p>


<p>数値 1234.5678E23 をさまざまな浮動小数点数出力形式で出力する例を以下に示します。
</p>
<div class="example">
<pre class="example-preformatted">1234.5678E23 f. 123456780000000000000000000.  ok
1234.5678E23 fe. 123.456780000000E24  ok
1234.5678E23 fs. 1.23456780000000E26  ok
1234.5678E23 fp. 123.456780000000Y  ok
</pre></div>

<p>出力桁幅は以下の影響を受けます:
</p>
<a class="index-entry-id" id="index-precision-_0028-_002d_002d-u-_0029-floating_002dext"></a>
<a class="index-entry-id" id="index-precision"></a>
<a class="index-entry-id" id="index-precision-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">precision</code> ( <i class="i">&ndash; u  </i>) floating-ext &ldquo;precision&rdquo;
</pre></div>
<p><i class="i">u</i> は、 <code class="code">f.</code> や <code class="code">fe.</code> や <code class="code">fs.</code> や <code class="code">fp.</code> で現在使用されている有効桁数です。 
</p>

<a class="index-entry-id" id="index-set_002dprecision-_0028-u-_002d_002d-_0029-floating_002dext"></a>
<a class="index-entry-id" id="index-set_002dprecision"></a>
<a class="index-entry-id" id="index-set_002dprecision-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">set-precision</code> ( <i class="i">u &ndash;  </i>) floating-ext &ldquo;set-precision&rdquo;
</pre></div>
<p><code class="code">f.</code> や <code class="code">fe.</code> や <code class="code">fs.</code> や <code class="code">fp.</code> で現在使用されている有効桁数を <i class="i">u</i>
に設定します。
</p>


<p>以下のコマンドを使用して、 出力をより詳細に制御できます:
</p>
<a class="index-entry-id" id="index-f_002erdp-_0028-rf-_002bnr-_002bnd-_002bnp-_002d_002d-_0029-gforth_002d0_002e6"></a>
<a class="index-entry-id" id="index-f_002erdp"></a>
<a class="index-entry-id" id="index-f_002erdp-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">f.rdp</code> ( <i class="i">rf +nr +nd +np &ndash;  </i>) gforth-0.6 &ldquo;f.rdp&rdquo;
</pre></div>
<p>浮動小数点数 <i class="i">rf</i> を書式化して表示します。 出力の合計幅は <i class="i">nr</i> です。  固定小数点表記の場合、 小数点以下の桁数は
<i class="i">+nd</i>、 有効桁数の最小値は <i class="i">np</i> です。  <code class="code">Set-precision</code> は <code class="code">f.rdp</code> には影響しません。
固定小数点表記は、 有効桁数が少なくとも <i class="i">np</i> の場合で、 かつ、 小数点以下の桁数が収まる場合に、 使用されます。
固定小数点表記が使用されない場合は指数表記が使用され、 それでも適合しない場合はアスタリスクが出力されます。
数値がまったく適合しないリスクを避けるために、 <i class="i">nr</i>&gt;=7 を使用することをお勧めします。 <code class="code">f.rdp</code>
が指数表記に切り替わるケースを避けるために、 <i class="i">nr</i>&gt;=<i class="i">np</i>+5 をお勧めします。 どうしてかというと、
固定小数点表記でも有効桁数が少なすぎるのに、 指数表記では有効桁数が更に少なくなるためです。 一部の数値を固定小数点表記しなければならない場合は、
<i class="i">nr</i>&gt;=<i class="i">nd</i>+2 をお勧めします。 <i class="i">np</i> の値が小さいほど、 より多くの場合で固定小数点表記で表示されます
(固定小数点表記に有効数字がほとんどまたはまったく残っていない場合)。  すべての数値を指数表記したい場合は、<i class="i">np</i>&gt;<i class="i">nr</i>
をお勧めします。
</p>


<p>出力にどのような影響を与えるかをより直感的に理解できるように、 パラメーターの組み合わせの例をいくつか示します。 各行内は同じ数値が出力されていて、
各列には同じパラメータの組み合わせが出力に使用されています:
</p>
<div class="example">
<pre class="example-preformatted">    12 13 0    7 3 4   7 3 0   7 3 1   7 5 1   7 7 1   7 0 2  4 2 1
|-1.234568E-6|-1.2E-6| -0.000|-1.2E-6|-1.2E-6|-1.2E-6|-1.2E-6|****|
|-1.234568E-5|-1.2E-5| -0.000|-1.2E-5|-.00001|-1.2E-5|-1.2E-5|****|
|-1.234568E-4|-1.2E-4| -0.000|-1.2E-4|-.00012|-1.2E-4|-1.2E-4|****|
|-1.234568E-3|-1.2E-3| -0.001| -0.001|-.00123|-1.2E-3|-1.2E-3|****|
|-1.234568E-2|-1.2E-2| -0.012| -0.012|-.01235|-1.2E-2|-1.2E-2|-.01|
|-1.234568E-1|-1.2E-1| -0.123| -0.123|-.12346|-1.2E-1|-1.2E-1|-.12|
|-1.2345679E0| -1.235| -1.235| -1.235|-1.23E0|-1.23E0|-1.23E0|-1E0|
|-1.2345679E1|-12.346|-12.346|-12.346|-1.23E1|-1.23E1|   -12.|-1E1|
|-1.2345679E2|-1.23E2|-1.23E2|-1.23E2|-1.23E2|-1.23E2|  -123.|-1E2|
|-1.2345679E3|-1.23E3|-1.23E3|-1.23E3|-1.23E3|-1.23E3| -1235.|-1E3|
|-1.2345679E4|-1.23E4|-1.23E4|-1.23E4|-1.23E4|-1.23E4|-12346.|-1E4|
|-1.2345679E5|-1.23E5|-1.23E5|-1.23E5|-1.23E5|-1.23E5|-1.23E5|-1E5|
</pre></div>

<p>以下を使用して、 数値を表示する代わりに文字列を生成できます:
</p>
<a class="index-entry-id" id="index-f_003estr_002drdp-_0028-rf-_002bnr-_002bnd-_002bnp-_002d_002d-c_002daddr-nr-_0029-gforth_002d0_002e6"></a>
<a class="index-entry-id" id="index-f_003estr_002drdp"></a>
<a class="index-entry-id" id="index-f_003estr_002drdp-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">f&gt;str-rdp</code> ( <i class="i">rf +nr +nd +np &ndash; c-addr nr  </i>) gforth-0.6 &ldquo;f&gt;str-rdp&rdquo;
</pre></div>
<p><i class="i">rf</i> を <i class="i">c-addr nr</i> の文字列に変換します。  <i class="i">nr +nd np</i> の変換規則と意味は <code class="code">f.rdp</code>
と同じです。  結果は表示数値出力(pictured numeric output)バッファーに格納され、
そのバッファを破壊するものによって破壊されます(訳注: このバッファーは、 他の 表示数値出力(pictured numeric output)
と共用であるということ)。
</p>

<a class="index-entry-id" id="index-f_003ebuf_002drdp-_0028-rf-c_002daddr-_002bnr-_002bnd-_002bnp-_002d_002d-_0029-gforth_002d0_002e6"></a>
<a class="index-entry-id" id="index-f_003ebuf_002drdp"></a>
<a class="index-entry-id" id="index-f_003ebuf_002drdp-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">f&gt;buf-rdp</code> ( <i class="i">rf c-addr +nr +nd +np &ndash;  </i>) gforth-0.6 &ldquo;f&gt;buf-rdp&rdquo;
</pre></div>
<p><i class="i">rf</i> を <i class="i">c-addr nr</i> の文字列に変換します。  <i class="i">nr nd np</i> の変換規則と意味は <code class="code">f.rdp</code>
と同じです。
</p>


<p>以下のような、 高レベルの FP-to-string ワードを実装するために使用されるプリミティブもあります:
</p>
<a class="index-entry-id" id="index-represent-_0028-r-c_002daddr-u-_002d_002d-n-f1-f2-_0029-floating"></a>
<a class="index-entry-id" id="index-represent"></a>
<a class="index-entry-id" id="index-represent-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">represent</code> ( <i class="i">r c-addr u &ndash; n f1 f2 </i>) floating &ldquo;represent&rdquo;
</pre></div>
<p><i class="i">r</i> の 10 進仮数部(別名 mantissa)をバッファ <i class="i">c-addr u</i> 内の文字列に変換します。 <i class="i">n</i> は指数で、<i class="i">r</i>
が負の場合は <i class="i">f1</i> が true、 <i class="i">r</i> が有効(Gforth の有限数)の場合は <i class="i">f2</i> が true です(訳注: 仮数部が u
の桁数になるようそれ以下を四捨五入するっぽい)。
</p>

</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Miscellaneous-output.html">Miscellaneous output</a>, Previous: <a href="Formatted-numeric-output.html">Formatted numeric output</a>, Up: <a href="Other-I_002fO.html">Other I/O</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
