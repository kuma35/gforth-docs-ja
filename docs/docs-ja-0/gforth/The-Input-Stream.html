<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright © 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>The Input Stream (Gforth マニュアル)</title>

<meta name="description" content="The Input Stream (Gforth マニュアル)">
<meta name="keywords" content="The Input Stream (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Words.html" rel="up" title="Words">
<link href="Word-Lists.html" rel="next" title="Word Lists">
<link href="The-Text-Interpreter.html" rel="prev" title="The Text Interpreter">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
pre.format-preformatted {font-family: inherit}
span:hover a.copiable-link {visibility: visible}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="section-level-extent" id="The-Input-Stream">
<div class="nav-panel">
<p>
Next: <a href="Word-Lists.html" accesskey="n" rel="next">Word Lists</a>, Previous: <a href="The-Text-Interpreter.html" accesskey="p" rel="prev">The Text Interpreter</a>, Up: <a href="Words.html" accesskey="u" rel="up">Forth Words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="The-Input-Stream-1"><span>6.15 The Input Stream<a class="copiable-link" href="#The-Input-Stream-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-input-stream"></a>

<p>テキスト・インタープリターは、 複数のソース(see <a class="pxref" href="Input-Sources.html">Input Sources</a>)が利用可能な入力ストリームから読み取ります。
いくつかのワード、特に定義ワードや <code class="code">'</code> のようなワードは、 スタックからではなく入力ストリームからパラメータを読み込みます。
</p>
<p>このようなワードは入力ストリームをパース(parse)するため、 パース・ワードと呼ばれます。 パース・ワードの使用は困難です。
なぜならプログラムで生成されたパラメーターを入力ストリームを通じて渡すのが難しいからです。 また、 素朴な実装をすると、
インタープリター機能(interpretation semantics)とコンパイル機能(compilation
semantics)の組み合わせが直感的でないことが多く、
より直感的な振る舞いを実現しようとする様々なアプローチが生まれています(see <a class="pxref" href="Combined-words.html">Combined Words</a>)。
</p>
<p>ワードをパースするのは悪い考えであることは、 最早明らかです。  あなたが、 利便性のためにパース・ワードを実装したいなら、 非パースのバリエーション、
つまり、 パースを行わずスタック上のパラメータを受け取るワードも提供してください。  もし、 その上でパース・ワードを実装するなら、
以下のワード群を使用できます:
</p>
<a class="index-entry-id" id="index-parse-_0028-xchar-_0022ccc_003cxchar_003e_0022-_002d_002d-c_002daddr-u-_0029-core_002dext_002cxchar_002dext"></a>
<a class="index-entry-id" id="index-parse"></a>
<a class="index-entry-id" id="index-parse-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">parse</code> ( <i class="i">xchar &quot;ccc&lt;xchar&gt;&quot; &ndash; c-addr u  </i>) core-ext,xchar-ext &ldquo;parse&rdquo;
</pre></div>
<p>パース領域で <i class="i">xchar</i> で区切られた <i class="i">ccc</i> をパースします。 <i class="i">c-addr u</i> は、
パース領域内でパースされた文字列を指します。 パース領域が空の場合、 <i class="i">u</i> は 0 です(訳注: <code class="code">bl parse ccc type
ccc ok</code> 。 直後でENTERキーを押して行を終了すると(<code class="code">parse</code> ENTER)、 長さ0の文字列をスタックに積む)
</p>

<a class="index-entry-id" id="index-string_002dparse-_0028-c_002daddr1-u1-_0022ccc_003cstring_003e_0022-_002d_002d-c_002daddr2-u2-_0029-gforth_002d1_002e0"></a>
<a class="index-entry-id" id="index-string_002dparse"></a>
<a class="index-entry-id" id="index-string_002dparse-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">string-parse</code> ( <i class="i">c-addr1 u1 &quot;ccc&lt;string&gt;&quot; &ndash; c-addr2 u2  </i>) gforth-1.0 &ldquo;string-parse&rdquo;
</pre></div>
<p>文字列 <i class="i">c-addr1 u1</i> で区切られた <i class="i">ccc</i> をパース領域でパースします。 <i class="i">c-addr2 u2</i> は、
パース領域内のパースされた文字列を指します。 パース領域が空の場合、 <i class="i">u2</i> は 0 です(訳注: <code class="code">&quot; &quot; string-parse
ccc type ccc ok</code>)
</p>

<a class="index-entry-id" id="index-parse_002dname-_0028-_0022name_0022-_002d_002d-c_002daddr-u-_0029-core_002dext"></a>
<a class="index-entry-id" id="index-parse_002dname"></a>
<a class="index-entry-id" id="index-parse_002dname-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">parse-name</code> ( <i class="i">&quot;name&quot; &ndash; c-addr u  </i>) core-ext &ldquo;parse-name&rdquo;
</pre></div>
<p>入力バッファーから次の単語(word)を取得します(訳注: <code class="code">parse-name ccc type ccc ok</code>)
</p>

<a class="index-entry-id" id="index-parse_002dword-_0028-_002d_002d-c_002daddr-u-_0029-gforth_002dobsolete"></a>
<a class="index-entry-id" id="index-parse_002dword"></a>
<a class="index-entry-id" id="index-parse_002dword-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">parse-word</code> ( <i class="i">&ndash; c-addr u  </i>) gforth-obsolete &ldquo;parse-word&rdquo;
</pre></div>
<p><code class="code">parse-name</code> の古い名前。 このワード語は、他の一部のシステムでは矛盾する振る舞いをします。
</p>

<a class="index-entry-id" id="index-name-_0028-_002d_002d-c_002daddr-u-_0029-gforth_002dobsolete"></a>
<a class="index-entry-id" id="index-name"></a>
<a class="index-entry-id" id="index-name-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">name</code> ( <i class="i">&ndash; c-addr u  </i>) gforth-obsolete &ldquo;name&rdquo;
</pre></div>
<p><code class="code">parse-name</code> の古い名前
</p>

<a class="index-entry-id" id="index-word-_0028-char-_0022_003cchars_003eccc_003cchar_003e_002d_002d-c_002daddr-_0029-core"></a>
<a class="index-entry-id" id="index-word-1"></a>
<a class="index-entry-id" id="index-word-2"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">word</code> ( <i class="i">char &quot;&lt;chars&gt;ccc&lt;char&gt;&ndash; c-addr  </i>) core &ldquo;word&rdquo;
</pre></div>
<p>先頭の区切り文字をスキップします。 パース領域で <i class="i">char</i> で区切られた <i class="i">ccc</i> をパースします。 <i class="i">c-addr</i> は、
カウンタ付き文字列形式で、 パースされた文字列を格納する一時領域のアドレスです。 パース領域が空であるか、 区切り文字以外の文字が含まれてい無い場合、
結果の文字列の長さはゼロになります。 プログラムは、 カウンタ付き文字列内の文字を置き換える場合があります。 時代遅れ(OBSOLESCENT):
カウンタ付き文字列の末尾に、 その長さに含まれないスペースがあります。
</p>

<a class="index-entry-id" id="index-refill-_0028-_002d_002d-flag-_0029-core_002dext_002cblock_002dext_002cfile_002dext"></a>
<a class="index-entry-id" id="index-refill"></a>
<a class="index-entry-id" id="index-refill-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">refill</code> ( <i class="i">&ndash; flag  </i>) core-ext,block-ext,file-ext &ldquo;refill&rdquo;
</pre></div>
<p>入力ソースにより入力バッファーを満たすことを試みます。 入力ソースがユーザー入力デバイスの場合、 端末入力デバイスからの入力の受け取りを試みます。
成功した場合は、 結果を入力バッファーにし、 <code class="code">&gt;IN</code> を 0 に設定して true を返します。 それ以外の場合は false
を返します。 入力ソースがブロックの場合、 <code class="code">BLK</code> の値に 1 を加算して、 次のブロックを入力ソースかつ現在の入力バッファーにし、
<code class="code">&gt;IN</code> を 0 に設定します。 <code class="code">BLK</code> の新しい値が有効なブロック番号の場合は true を返し、 それ以外の場合は
false を返します。 入力ソースがテキスト・ファイルの場合、 ファイルから次の行を読み取ろうと試みます。 成功した場合は、
結果を現在の入力バッファーにし、 <code class="code">&gt;IN</code> を 0 に設定して true を返します。 それ以外の場合は false を返します。
いずれの場合も、 成功した結果には、0 文字を含む行の受け取りが含まれます。
</p>


<p>非パースなバリエーションが無いパース・ワードを取り扱う必要がある場合、 <code class="code">execute-parsing</code>
を使用して(スタック経由で)文字列を渡すことができます:
</p>
<a class="index-entry-id" id="index-execute_002dparsing-_0028-_002e_002e_002e-addr-u-xt-_002d_002d-_002e_002e_002e-_0029-gforth_002d0_002e6"></a>
<a class="index-entry-id" id="index-execute_002dparsing"></a>
<a class="index-entry-id" id="index-execute_002dparsing-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">execute-parsing</code> ( <i class="i">... addr u xt &ndash; ...  </i>) gforth-0.6 &ldquo;execute-parsing&rdquo;
</pre></div>
<p><i class="i">addr u</i> を現在の入力ソースにして <i class="i">xt <code class="code">( ... -- ... )</code></i> を実行してから、
以前の入力ソースを復元します。
</p>


<p>Example:
</p>
<div class="example">
<pre class="example-preformatted">5 s&quot; foo&quot; ' constant execute-parsing
\ これは、以下と同等です
5 constant foo
</pre></div>

<p>標準 Forth でのこのワードの定義は <samp class="file">compat/execute-parsing.fs</samp> で提供されます。
</p>
<p>ファイルに対してワードのパースを実行したい場合は、 以下のワードが役に立ちます:
</p>
<a class="index-entry-id" id="index-execute_002dparsing_002dfile-_0028-i_002ax-fileid-xt-_002d_002d-j_002ax-_0029-gforth_002d0_002e6"></a>
<a class="index-entry-id" id="index-execute_002dparsing_002dfile"></a>
<a class="index-entry-id" id="index-execute_002dparsing_002dfile-1"></a>
<div class="format">
<pre class="format-preformatted"><code class="code">execute-parsing-file</code> ( <i class="i">i*x fileid xt &ndash; j*x  </i>) gforth-0.6 &ldquo;execute-parsing-file&rdquo;
</pre></div>
<p><i class="i">fileid</i> を現在の入力ソースにして、 <i class="i">xt <code class="code">( i*x -- j*x )</code></i> を実行してから、
以前の入力ソースを復元します。
</p>


</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Word-Lists.html">Word Lists</a>, Previous: <a href="The-Text-Interpreter.html">The Text Interpreter</a>, Up: <a href="Words.html">Forth Words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
