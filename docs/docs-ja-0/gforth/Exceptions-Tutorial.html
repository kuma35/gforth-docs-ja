<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Exceptions Tutorial (Gforth マニュアル)</title>

<meta name="description" content="Exceptions Tutorial (Gforth マニュアル)">
<meta name="keywords" content="Exceptions Tutorial (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Tutorial.html" rel="up" title="Tutorial">
<link href="Defining-Words-Tutorial.html" rel="next" title="Defining Words Tutorial">
<link href="Execution-Tokens-Tutorial.html" rel="prev" title="Execution Tokens Tutorial">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="section" id="Exceptions-Tutorial">
<div class="header">
<p>
Next: <a href="Defining-Words-Tutorial.html" accesskey="n" rel="next">Defining Words</a>, Previous: <a href="Execution-Tokens-Tutorial.html" accesskey="p" rel="prev">Execution Tokens</a>, Up: <a href="Tutorial.html" accesskey="u" rel="up">Forth Tutorial</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Exceptions"></span><h3 class="section">3.30 Exceptions</h3>
<span id="index-exceptions-tutorial"></span>

<p><code>throw ( n -- )</code> は、 n がゼロでない限り例外を引き起こします。
</p>
<div class="example">
<pre class="example">100 throw .s
0 throw .s
</pre></div>

<p><code>catch ( ... xt -- ... n )</code> は <code>execute</code> と同様に動作しますが、 例外をキャッチし、
スタック上に例外の数値(または XT が例外なしで実行された場合は 0)をプッシュします。 例外があった場合、 スタックの深さは
<code>catch</code> の実行直前と同一です。
</p>
<div class="example">
<pre class="example">.s
3 0 ' / catch .s
3 2 ' / catch .s
</pre></div>

<blockquote>
<p><b>研究課題(assignment):</b> <code>catch</code> の代わりに <code>execute</code> を使用して同じことを試してみましょう。
</p></blockquote>

<p><code>throw</code> は、常に動的に直近にこの <code>throw</code> を囲んでいる(定義の) <code>catch</code> にジャンプします、
たとえそのジャンプを達成するために複数の呼び出しレベルを飛び越す必要がある場合でもです:
</p>
<div class="example">
<pre class="example">: foo 100 throw ;
: foo1 foo .&quot; after foo&quot; ;
: bar ['] foo1 catch ;
bar .
</pre></div>

<p>多くの場合、 定義が例外によって終了した場合でも、 定義を終了したときに値を復元することが重要です。 以下のようにしてみるのはどうでしょうか:
</p>
<div class="example">
<pre class="example">: ...
   save-x
   ['] word-changing-x catch ( ... n )
   restore-x
   ( ... n ) throw ;
</pre></div>

<p>しかし、 これでも、 たとえば、<code>catch</code> と <code>restore-x</code> の間を実行中にユーザーが <kbd>Ctrl-C</kbd>
を押すなどしたら安全ではありません。
</p>
<p>Gforth は、そのような場合に対して安全な代替例外処理構文(alternative exception handling syntax)
<code>try ...restore ... endtry</code> を提供します。  <code>try</code> と <code>endtry</code>
の間のコードに例外があった場合、 スタックの深さが復元され、 例外数値がスタックにプッシュされ、 <code>restore</code>
の直後から実行が続行されます。
</p>
<p>以下は、 上記のコードと同等の、 より安全なコードです
</p>
<div class="example">
<pre class="example">: ...
  save-x
  try
    word-changing-x 0
  restore
    restore-x
  endtry
  throw ;
</pre></div>

<p>こちらも参照ください: <a href="Exception-Handling.html">Exception Handling</a>
</p>

</div>



</body>
</html>
