<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Basic multi-tasking (Gforth マニュアル)</title>

<meta name="description" content="Basic multi-tasking (Gforth マニュアル)">
<meta name="keywords" content="Basic multi-tasking (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Pthreads.html" rel="up" title="Pthreads">
<link href="Task_002dlocal-data.html" rel="next" title="Task-local data">
<link href="Pthreads.html" rel="prev" title="Pthreads">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="subsubsection" id="Basic-multi_002dtasking">
<div class="header">
<p>
Next: <a href="Task_002dlocal-data.html" accesskey="n" rel="next">Task-local data</a>, Previous: <a href="Pthreads.html" accesskey="p" rel="prev">Pthreads</a>, Up: <a href="Pthreads.html" accesskey="u" rel="up">Pthreads</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Basic-multi_002dtasking-1"></span><h4 class="subsubsection">6.27.1.1 Basic multi-tasking</h4>

<p>タスクは <code>newtask</code> または <code>newtask4</code> を使用して、 指定された量のスタック領域(すべて同じ、 または、
データ・スタックとリターン・スタックと FP スタックとローカル変数スタックそれぞれのサイズを指定)で作成できます。
</p>
<span id="index-newtask-_0028--stacksize-_002d_002d-task--_0029-gforth_002dexperimental"></span>
<span id="index-newtask"></span>
<span id="index-newtask-1"></span>
<div class="format">
<pre class="format"><code>newtask</code> ( <i>stacksize &ndash; task  </i>) gforth-experimental &ldquo;newtask&rdquo;
</pre></div>
<p>タスク(<i>task</i>を作成します。 データ・スタックとリターン・スタックと FP
スタックとローカル変数スタックのサイズは全て同じにします(<i>stacksize</i>)(訳注: スタックごとに個別サイズ指定したい時は
<code>newtask4</code> を使用してください)。
</p>

<span id="index-task-_0028--ustacksize-_0022name_0022-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-task"></span>
<span id="index-task-1"></span>
<div class="format">
<pre class="format"><code>task</code> ( <i>ustacksize &quot;name&quot; &ndash;  </i>) gforth-experimental &ldquo;task&rdquo;
</pre></div>
<p>タスク <i>name</i> を作成します。 各スタック(データ・スタック、 リターン・スタック、 FP スタック、 ローカル変数スタック) サイズは
<i>ustacksize</i> です。<br>実行時: ( &ndash; <i>task</i> )
</p>

<span id="index-newtask4-_0028--u_002ddata-u_002dreturn-u_002dfp-u_002dlocals-_002d_002d-task--_0029-gforth_002dexperimental"></span>
<span id="index-newtask4"></span>
<span id="index-newtask4-1"></span>
<div class="format">
<pre class="format"><code>newtask4</code> ( <i>u-data u-return u-fp u-locals &ndash; task  </i>) gforth-experimental &ldquo;newtask4&rdquo;
</pre></div>
<p>データ・スタック・サイズ <i>u-data</i>、 リターン・スタック・サイズ <i>u-return</i>、 FP スタック・サイズ <i>u-fp</i>、
ローカル変数スタック・サイズ <i>u-locals</i> で <i>task</i> を作成します。
</p>


<p>あなたが、 タスクにどのスタック・サイズを使用すればよいかわからない場合は、 メイン・タスクのサイズを流用できます:
</p>
<span id="index-stacksize-_0028--_002d_002d-u--_0029-gforth_002dexperimental"></span>
<span id="index-stacksize"></span>
<span id="index-stacksize-1"></span>
<div class="format">
<pre class="format"><code>stacksize</code> ( <i>&ndash; u  </i>) gforth-experimental &ldquo;stacksize&rdquo;
</pre></div>
<p><i>u</i> はメイン・タスクのデータ・スタックサイズです。
</p>

<span id="index-stacksize4-_0028--_002d_002d-u_002ddata-u_002dreturn-u_002dfp-u_002dlocals--_0029-gforth_002dexperimental"></span>
<span id="index-stacksize4"></span>
<span id="index-stacksize4-1"></span>
<div class="format">
<pre class="format"><code>stacksize4</code> ( <i>&ndash; u-data u-return u-fp u-locals  </i>) gforth-experimental &ldquo;stacksize4&rdquo;
</pre></div>
<p>メイン・タスクのデータ・スタック・サイズと、 リターン・スタック・サイズと、 FP スタック・サイズと、 ローカル変数スタックサイズを、
プッシュします。
</p>


<p>タスクは非アクティブ状態(inactive state)で作成されます。  実行するには、
以下のいずれかのワードを使用してアクティブ化(activate)する必要があります:
</p>
<span id="index-initiate-_0028--xt-task-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-initiate"></span>
<span id="index-initiate-1"></span>
<div class="format">
<pre class="format"><code>initiate</code> ( <i>xt task &ndash;  </i>) gforth-experimental &ldquo;initiate&rdquo;
</pre></div>
<p><i>task</i> に <i>xt</i> を <i>execute</i> させます。  <i>xt</i> から戻ると、 タスクは自動的に終了します(VFX 互換)。
ワンタイム実行可能クロージャ(one-time executable closures)を使用して、 任意のパラメータをタスクに渡せます。
</p>


<p>以下の古い(legacy)ワード、 <code>activate</code> と <code>pass</code> は、 <code>initiate</code>
と同じ機能を提供しますが、 インターフェイスが異なります:  <code>does&gt;</code> と同様に、 含まれるコロン定義が 2 つの部分に分割されます:
<code>activate</code>/<code>pass</code> より前の部分はタスクをアクティブ化する部分で実行され、
タスクをアクティブ化した後に呼び出し元に戻ります。  <code>activate</code>/<code>pass</code> より後の部分は、
アクティブ化されたターゲット・タスク内で実行されます。
</p>
<span id="index-activate-_0028--run_002dtime-nest_002dsys1-task-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-activate"></span>
<span id="index-activate-1"></span>
<div class="format">
<pre class="format"><code>activate</code> ( <i>run-time nest-sys1 task &ndash;  </i>) gforth-experimental &ldquo;activate&rdquo;
</pre></div>
<p>指定のタスク(<i>task</i>)に <code>activate</code> のより後ろにあるコードを実行させ、 <code>activate</code>
を含むワードの呼び出し元に戻ります。 タスクが <code>activate</code> の後ろにあるコードから戻ると、 タスク自体が終了します。
</p>

<span id="index-pass-_0028--x1-_002e_002e-xn-n-task-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-pass"></span>
<span id="index-pass-1"></span>
<div class="format">
<pre class="format"><code>pass</code> ( <i>x1 .. xn n task &ndash;  </i>) gforth-experimental &ldquo;pass&rdquo;
</pre></div>
<p>現在のタスクのデータ・スタックから <i>x1 .. xn n</i> を取り出し、 <i>x1 .. xn</i> を <i>task</i>
のデータ・スタックにプッシュします。  <i>task</i> に <code>pass</code> の後ろのコードを実行させ、 <code>pass</code>
を含むワードの呼び出し元に戻ります。  タスクが <code>pass</code> の後ろにあるコードから戻ると、 タスク自体が終了します。
</p>


<p>作成とアクティブ化(activation)をワン・ステップで行うこともできます:
</p>
<span id="index-execute_002dtask-_0028--xt-_002d_002d-task--_0029-gforth_002dexperimental"></span>
<span id="index-execute_002dtask"></span>
<span id="index-execute_002dtask-1"></span>
<div class="format">
<pre class="format"><code>execute-task</code> ( <i>xt &ndash; task  </i>) gforth-experimental &ldquo;execute-task&rdquo;
</pre></div>
<p>メイン・タスクと同じスタック・サイズで新しいタスク <var>task</var> を作成します。 <i>task</i> に <i>xt</i> を <i>execute</i>
させます。  <i>xt</i> から戻ると、 タスクは自動的に終了します。
</p>


<p>タスクは最後まで実行して終了する以外に、 <code>kill-task</code> を使用してタスク自身を終了することもできます。 他のタスクは
<code>kill</code> で終了できます。
</p>
<span id="index-kill_002dtask-_0028--_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-kill_002dtask"></span>
<span id="index-kill_002dtask-1"></span>
<div class="format">
<pre class="format"><code>kill-task</code> ( <i>&ndash;  </i>) gforth-experimental &ldquo;kill-task&rdquo;
</pre></div>
<p>現在のタスクを終了(terminate)します。
</p>

<span id="index-kill-_0028--task-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-kill"></span>
<span id="index-kill-1"></span>
<div class="format">
<pre class="format"><code>kill</code> ( <i>task &ndash;  </i>) gforth-experimental &ldquo;kill&rdquo;
</pre></div>
<p>指定のタスク(<i>task</i>)を終了(terminate)します。
</p>


<p>タスク自体を一時的に停止(temporarily stop)したり、 タスクを停止(be stopped)したりすることもできます:
</p>
<span id="index-halt-_0028--task-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-halt"></span>
<span id="index-halt-1"></span>
<div class="format">
<pre class="format"><code>halt</code> ( <i>task &ndash;  </i>) gforth-experimental &ldquo;halt&rdquo;
</pre></div>
<p>タスクを停止(stop)する
</p>

<span id="index-stop-_0028--_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-stop"></span>
<span id="index-stop-1"></span>
<div class="format">
<pre class="format"><code>stop</code> ( <i>&ndash;  </i>) gforth-experimental &ldquo;stop&rdquo;
</pre></div>
<p>現在のタスクを停止(stop)し、 イベントを待ちます(再起動(restart)される可能性があります)
</p>

<span id="index-stop_002dns-_0028--timeout-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-stop_002dns"></span>
<span id="index-stop_002dns-1"></span>
<div class="format">
<pre class="format"><code>stop-ns</code> ( <i>timeout &ndash;  </i>) gforth-experimental &ldquo;stop-ns&rdquo;
</pre></div>
<p>タイムアウト(ナノ秒単位)まで停止(stop)します。 <code>ms</code> のより良い代替品です
</p>


<p>タスクは、 タイムアウトが経過(timeout is over)するか、
別のタスクが以下のワードでウェイクアップ(wake)すると再起動(restart)します:
</p>
<span id="index-restart-_0028--task-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-restart"></span>
<span id="index-restart-1"></span>
<div class="format">
<pre class="format"><code>restart</code> ( <i>task &ndash;  </i>) gforth-experimental &ldquo;restart&rdquo;
</pre></div>
<p>タスクを起動(wake)する
</p>


<p>こちらもどうぞ:
</p>
<span id="index-pause-_0028--_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-pause"></span>
<span id="index-pause-1"></span>
<div class="format">
<pre class="format"><code>pause</code> ( <i>&ndash;  </i>) gforth-experimental &ldquo;pause&rdquo;
</pre></div>
<p>次の待機中のタスクに自発的に切り替えます(<code>pause</code> は従来の協調(cooperative)タスク・スイッチャー(切替器)です。
pthread マルチタスクでは、 協調するのに <code>pause</code> は必要ありませんが、 それでも使用できます。 例えば、
何らかの理由でポーリングに頼らなければならないときです)。 これにより、 キュー内のイベントもチェックされます。
</p>


</div>
<hr>
<div class="header">
<p>
Next: <a href="Task_002dlocal-data.html">Task-local data</a>, Previous: <a href="Pthreads.html">Pthreads</a>, Up: <a href="Pthreads.html">Pthreads</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
