<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Introducing the Text Interpreter (Gforth マニュアル)</title>

<meta name="description" content="Introducing the Text Interpreter (Gforth マニュアル)">
<meta name="keywords" content="Introducing the Text Interpreter (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Introduction.html" rel="up" title="Introduction">
<link href="Stacks-and-Postfix-notation.html" rel="next" title="Stacks and Postfix notation">
<link href="Introduction.html" rel="prev" title="Introduction">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="section" id="Introducing-the-Text-Interpreter">
<div class="header">
<p>
Next: <a href="Stacks-and-Postfix-notation.html" accesskey="n" rel="next">Stacks, postfix notation and parameter passing</a>, Previous: <a href="Introduction.html" accesskey="p" rel="prev">An Introduction to Standard Forth</a>, Up: <a href="Introduction.html" accesskey="u" rel="up">An Introduction to Standard Forth</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Introducing-the-Text-Interpreter-1"></span><h3 class="section">4.1 Introducing the Text Interpreter</h3>
<span id="index-text-interpreter"></span>
<span id="index-outer-interpreter"></span>



<p>Forth イメージを呼び出すと、 起動バナーが出力されますが、 他には何も表示されません (システムに Gforth がインストールされている場合は、
<kbd>gforth<span class="key">RET</span></kbd> と入力して今すぐ呼び出してみてください)。 今、 Forth は、 テキスト・インタープリター(Text
Interpreter)と呼ばれるコマンド・ライン・インタプリタを実行しています(外部インタープリターとも呼ばれます;訳注: 別途存在する
内部インタープリター(inner interpreter)に対してこう呼ばれる)。
(この章を読み進ればテキスト・インタープリターについて多くのことを学ぶことができます。 詳細については see <a href="The-Text-Interpreter.html">The Text Interpreter</a> を参照してください)。
</p>
<p>明白ではなくて分かりにくいですが、 今や Forth はユーザーの入力を待っています。 数字の 4 と 5 を入力し <tt class="key">RET</tt>
キーを押します:
</p>
<div class="example">
<pre class="example"><kbd>45<span class="key">RET</span></kbd>  ok
</pre></div>

<p>テキスト・インタープリターは、  次の入力を促すプロンプトを表示するのではなく、 入力行を処理した後に(改行無しで)ステータス・メッセージを出力します。
この場合のステータス・メッセージ(<tt class="key">RET</tt> (「エンター」(リターン)キー押下)の後の <code> ok</code> )は、
テキスト・インタープリターがすべての入力を正常に処理できたことを示します。 それでは次に、 不正な文字列を入力してみましょう:
</p>
<div class="example">
<pre class="example"><kbd>qwer341<span class="key">RET</span></kbd>
*the terminal*:2: Undefined word
&gt;&gt;&gt;qwer341&lt;&lt;&lt;
Backtrace:
$2A95B42A20 throw 
$2A95B57FB8 no.extensions 
</pre></div>

<p>&lsquo;Undefined word&lsquo; 以外の文章はシステムによって若干異なる場合がありますが、 意味は同じです。
テキスト・インタープリターがエラーを検出すると、 行に残っているテキストを破棄し、 特定の内部状態をリセットして、 エラー・メッセージを出力します。
エラー・メッセージの詳細な説明については、 <a href="Error-messages.html">Error messages</a> を参照してください。
</p>
<p>テキスト・インタープリターは、エンター・キー(リターン・キー)が押されるのを待ち、 その後入力行を処理します。 行頭から開始して、
行をスペースで区切られた文字のグループに分割します。 文字のグループごとに、 以下の順番で、 何かするために計 2 回の試みを行います:
</p>
<ul>
<li> <span id="index-name-dictionary"></span>
<span id="index-word"></span>
<span id="index-definition"></span>
<span id="index-execution-token"></span>
<span id="index-xt"></span>
その文字のグループをコマンドとして扱おうとします。 これは、 名前ディクショナリ(name dictionary)を検索することによって行われます。
その文字のグループが名前ディクショナリのエントリと一致する場合、 名前ディクショナリは、
いくつかのアクションを実行できるようにする情報をテキスト・インタープリターに提供します。 Forth
流に言うと、文字のグループを「ワードの名前」といい、 ディクショナリ検索でワードの定義(definition)に対応する実行トークン(execution
token;xt)が返され、 テキスト・インタープリターは xt を実行します。
多くの場合、「ワード」(word)と「定義」(definition)という用語は同じ意味で使用されます。
</li><li> テキスト・インタープリターが名前ディクショナリ内で一致するものを見つけられなかった場合、
文字のグループを現在の基数の数値として処理しようとします(Forth を起動したときの、 現在の基数は 10 です)。
文字のグループが正当な数値を表す場合、
テキスト・インタープリターはその数値をスタックにプッシュします(これについては次のセクションで詳しく説明します)。
</li></ul>

<p>テキスト・インタープリターが文字グループに対して上記のいずれも実行不可能な場合、 その文字グループと行の残りの部分が破棄され、
エラー・メッセージが出力されます。 テキスト・インタープリターがエラーなく行末に到達すると、 ステータス・メッセージ <code> ok</code>
に続いて改行を出力します。
</p>
<p>以下は、 テキスト・インタープリターに与えることができる最もシンプルなコマンドです:
</p>
<div class="example">
<pre class="example"><span class="key">RET</span>  ok
</pre></div>

<p>ここで、 テキスト・インタープリターは、 私たちが要求したことをすべて(何もせずに)エラーなしで実行したため、 すべてが <code> ok</code>
であると表示しました。 今度は少し長いコマンドを試して見ましょう:
</p>
<div class="example">
<pre class="example"><kbd>12 dup fred dup<span class="key">RET</span></kbd>
*the terminal*:3: Undefined word
12 dup &gt;&gt;&gt;fred&lt;&lt;&lt; dup
Backtrace:
$2A95B42A20 throw 
$2A95B57FB8 no.extensions 
</pre></div>

<p>エンター・キー(リターン・キー)を押すと、 テキスト・インタープリターが行に沿って動作を開始します:
</p>
<ul>
<li> <code>2</code> の後のスペースに到達すると、 文字グループ <code>12</code> を取得し、
それらを名前ディクショナリで検索します<a id="DOCF5" href="#FOOT5"><sup>5</sup></a>。
名前ディクショナリにはこの文字グループに一致するものがないため、それらを数値として処理しようとし、 そして、
数値として処理するのは正常に実行できたので、 (それが何を意味するにせよ) 数値 12 を「スタック上」に置きます。
</li><li> テキスト・インタープリターは行のスキャンを再開し、 次の文字グループ &lsquo;dup&lsquo; を取得します。  &lsquo;dup&lsquo; を名前ディクショナリで探し、
(これは著者の言葉を信じてもらうしかありませんが)  &lsquo;dup&lsquo; を名前ディクショナリで見付けて、 ワード <code>dup</code>
を実行します(それが何を意味していても)。
</li><li> 更に再び、 テキスト・インタープリターは行のスキャンを再開し、 文字グループ <code>fred</code> を取得します。
名前ディクショナリで調べますが、見つかりません。 それらを数値として扱おうとしますが、 正当な数値を表すものではありませんでした。
</li></ul>

<p>この時点で、 テキスト・インタープリターは諦めてエラー・メッセージを出力します。 エラー・メッセージには、
テキスト・インタープリターが行の処理でどこまで到達したかが正確に示されます。 これは、 特に、 テキスト・インタープリターが最後の文字グループ
<code>dup</code> に対して何も行おうとしなかったことを示しています。 テキスト・インタプリタがそのワード <code>dup</code> を検索して、
一度はちゃんと実行されたのですから、 もう一度実行することに何の問題はないはずなのに、 です。 
</p>

</div>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5><a id="FOOT5" href="#DOCF5">(5)</a></h5>
<p>見つかったかどうかはわかりませんが、いまのところ、 見つからなかったと仮定します。 訳注:
12 というワードを定義することもでき、その場合はワード 12 の方が数値 12 より優先される</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Stacks-and-Postfix-notation.html">Stacks, postfix notation and parameter passing</a>, Previous: <a href="Introduction.html">An Introduction to Standard Forth</a>, Up: <a href="Introduction.html">An Introduction to Standard Forth</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
