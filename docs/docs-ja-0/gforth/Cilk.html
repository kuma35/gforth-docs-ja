<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Cilk (Gforth マニュアル)</title>

<meta name="description" content="Cilk (Gforth マニュアル)">
<meta name="keywords" content="Cilk (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Multitasker.html" rel="up" title="Multitasker">
<link href="Pthreads.html" rel="prev" title="Pthreads">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="subsection" id="Cilk">
<div class="header">
<p>
Previous: <a href="Pthreads.html" accesskey="p" rel="prev">Pthreads</a>, Up: <a href="Multitasker.html" accesskey="u" rel="up">Multitasker</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Cilk-1"></span><h4 class="subsection">6.27.2 Cilk</h4>

<p>gforth の Cilk は、 同じ名前のプログラミング言語からインスピレーションを得た、
複数のコアで実行される複数のタスク間で作業を分割するためのフレームワークです。  Cilk を使用する場合は、 <code>require
cilk.fs</code> としてください。
</p>
<p>考え方としては、 並行して解決できる部分問題(subproblems)を特定し、
フレームワークがワーカー・タスクをこれらの部分問題に割り当てるというものです。 特に、 各サブ・タスクに対して <code>spawn</code> ワードの 1
つを使用します。  最終的には、 部分問題が解決されるまで <code>cilk-sync</code> で待つ必要があります。
</p>
<p>現在、 すべての生成は 1 つのタスクから発生する必要があり、 <code>cilk-sync</code>
はすべての部分問題(subproblems)が完了するまで待機するため、 再帰アルゴリズムに現在の gforth Cilk
を使用するのは簡単ではありません。
</p>
<p>オーバーヘッドを避けるために、 部分問題を細かく分割しすぎないでください。 どのくらい細かいかは、
部分問題の実行時間がどの程度均一であるかによって決まりますが、 かなりの実行時間の問題の場合は、 5*<code>cores</code>
個の部分問題(subproblems)にするのが、 おそらく良い出発点となります。
</p>
<span id="index-cores-_0028--_002d_002d-u--_0029-cilk"></span>
<span id="index-cores"></span>
<span id="index-cores-1"></span>
<div class="format">
<pre class="format"><code>cores</code> ( <i>&ndash; u  </i>) cilk &ldquo;cores&rdquo;
</pre></div>
<p>使用するワーカー・タスクの数を含む値。  デフォルトでは、 これはハードウェア・スレッドの数(SMT/HT の場合)です。
(決定できれば、)それ以外の場合は 1 になります。 別の数を使用したい場合は、 <code>cilk-init</code> を呼び出す前に
<code>cores</code> を変更します。 
</p>

<span id="index-cilk_002dinit-_0028--_002d_002d--_0029-cilk"></span>
<span id="index-cilk_002dinit"></span>
<span id="index-cilk_002dinit-1"></span>
<div class="format">
<pre class="format"><code>cilk-init</code> ( <i>&ndash;  </i>) cilk &ldquo;cilk-init&rdquo;
</pre></div>
<p>ワーカー・タスクがまだ実行されていない場合は開始します。
</p>

<span id="index-spawn-_0028--xt-_002d_002d--_0029-cilk"></span>
<span id="index-spawn"></span>
<span id="index-spawn-1"></span>
<div class="format">
<pre class="format"><code>spawn</code> ( <i>xt &ndash;  </i>) cilk &ldquo;spawn&rdquo;
</pre></div>
<p>ワーカー・タスクで <i>xt</i> ( &ndash; ) を <i>execute</i> します。  使い捨て実行可能クロージャ(one-time
executable closures)を使用して、 ヒープに割り当てられたクロージャを渡し、 <code>spawn</code> 呼び出し側から、
ワーカーで実行されているコードに任意のデータを渡すことができます。<br> 例: <code>( n r ) [{: n f: r :}h1 code
;] spawn</code>
</p>

<span id="index-spawn1-_0028--x-xt-_002d_002d--_0029-cilk"></span>
<span id="index-spawn1"></span>
<span id="index-spawn1-1"></span>
<div class="format">
<pre class="format"><code>spawn1</code> ( <i>x xt &ndash;  </i>) cilk &ldquo;spawn1&rdquo;
</pre></div>
<p>Execute <i>xt</i> ( x &ndash; ) in a worker task.
</p>

<span id="index-spawn2-_0028--x1-x2-xt-_002d_002d--_0029-cilk"></span>
<span id="index-spawn2"></span>
<span id="index-spawn2-1"></span>
<div class="format">
<pre class="format"><code>spawn2</code> ( <i>x1 x2 xt &ndash;  </i>) cilk &ldquo;spawn2&rdquo;
</pre></div>
<p>Execute <i>xt</i> ( x1 x2 &ndash; ) in a worker task.
</p>

<span id="index-cilk_002dsync-_0028--_002d_002d--_0029-cilk"></span>
<span id="index-cilk_002dsync"></span>
<span id="index-cilk_002dsync-1"></span>
<div class="format">
<pre class="format"><code>cilk-sync</code> ( <i>&ndash;  </i>) cilk &ldquo;cilk-sync&rdquo;
</pre></div>
<p>すべての部分問題が完了(complete)するまで待ちます(wait)。
</p>

<span id="index-cilk_002dbye-_0028--_002d_002d--_0029-cilk"></span>
<span id="index-cilk_002dbye"></span>
<span id="index-cilk_002dbye-1"></span>
<div class="format">
<pre class="format"><code>cilk-bye</code> ( <i>&ndash;  </i>) cilk &ldquo;cilk-bye&rdquo;
</pre></div>
<p>すべてのワーカーを終了(terminate)します。
</p>


</div>



</body>
</html>
