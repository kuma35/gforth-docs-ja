<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>ARM Assembler (Gforth マニュアル)</title>

<meta name="description" content="ARM Assembler (Gforth マニュアル)">
<meta name="keywords" content="ARM Assembler (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Assembler-and-Code-Words.html" rel="up" title="Assembler and Code Words">
<link href="Other-assemblers.html" rel="next" title="Other assemblers">
<link href="PowerPC-assembler.html" rel="prev" title="PowerPC assembler">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="subsection" id="ARM-Assembler">
<div class="header">
<p>
Next: <a href="Other-assemblers.html" accesskey="n" rel="next">Other assemblers</a>, Previous: <a href="PowerPC-assembler.html" accesskey="p" rel="prev">PowerPC assembler</a>, Up: <a href="Assembler-and-Code-Words.html" accesskey="u" rel="up">Assembler and Code Words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="ARM-Assembler-1"></span><h4 class="subsection">6.29.9 ARM Assembler</h4>

<p>ARM アセンブラには、 ARM アーキテクチャ・バージョン 4 のすべての命令と、 アーキテクチャ・バージョン 5 の BLX 命令が含まれています。
Thumb 命令は (まだ) サポートされていません。  また、 コ・プロセッサーもサポートされていません。
</p>
<p>アセンブラは、 「ARM Architecture Reference
Manual」で使用されているのと同じオペランド順序を持つ後置構文(postfix syntax)を使用します。
ニーモニックにはカンマが付けられます。
</p>
<p>レジスタは <code>r0</code>〜<code>r15</code> までの名前で指定され、別名は <code>pc</code>, <code>lr</code>, <code>sp</code>,
<code>ip</code>, <code>fp</code> で、これらは利便性のために提供されています。  <code>ip</code>
は「プロシージャ内呼び出しスクラッチ・レジスタ」(intra procedure call scratch register)(注意:
<code>r12</code>) を指し、 命令ポインターを指すわけではないことに注意してください。  <code>sp</code> は、 Forth
のスタック・ポインターではなく、 ARM ABI スタック・ポインター (<code>r13</code>) を指します。
</p>
<p>条件コードは命令内のどこにでも指定できますが、 ニーモニックの直前に指定すると最も読みやすくなります。  「S」フラグは別個のワードではなく、
命令ニーモニックにエンコードされます。 ステータス・レジスタを更新したい場合は、 <code>add,</code> の代わりに <code>adds,</code>
を使用してください。
</p>
<p>以下の表に、 一般的な命令のオペランドの構文を示します:
</p>
<div class="example">
<pre class="example">Gforth          normal assembler      description
123 #           #123                  immediate
r12             r12                   register
r12 4 #LSL      r12, LSL #4           shift left by immediate
r12 r1 LSL      r12, LSL r1           shift left by register
r12 4 #LSR      r12, LSR #4           shift right by immediate
r12 r1 LSR      r12, LSR r1           shift right by register
r12 4 #ASR      r12, ASR #4           arithmetic shift right
r12 r1 ASR      r12, ASR r1           ... by register
r12 4 #ROR      r12, ROR #4           rotate right by immediate
r12 r1 ROR      r12, ROR r1           ... by register
r12 RRX         r12, RRX              rotate right with extend by 1
</pre></div>

<p>メモリ・オペランドの構文を以下の表に示します:
</p>
<div class="example">
<pre class="example">Gforth            normal assembler      description
r4 ]              [r4]                  register
r4 4 #]           [r4, #+4]             register with immediate offset
r4 -4 #]          [r4, #-4]             with negative offset
r4 r1 +]          [r4, +r1]             register with register offset
r4 r1 -]          [r4, -r1]             with negated register offset
r4 r1 2 #LSL -]   [r4, -r1, LSL #2]     with negated and shifted offset
r4 4 #]!          [r4, #+4]!            immediate preincrement
r4 r1 +]!         [r4, +r1]!            register preincrement
r4 r1 -]!         [r4, +r1]!            register predecrement
r4 r1 2 #LSL +]!  [r4, +r1, LSL #2]!    shifted preincrement
r4 -4 ]#          [r4], #-4             immediate postdecrement
r4 r1 ]+          [r4], r1              register postincrement
r4 r1 ]-          [r4], -r1             register postdecrement
r4 r1 2 #LSL ]-   [r4], -r1, LSL #2     shifted postdecrement
' xyz &gt;body [#]   xyz                   PC-relative addressing
</pre></div>

<p>複数のロード/ストア命令のレジスタ・リストは、 それぞれ <code>{</code> および <code>}</code> というワードを使用して開始および終了します。
<code>{</code> 〜 <code>}</code>  の間に、 レジスタ名を 1 つずつリストすることも、 後置演算子 <code>r-r</code>
を使用してレジスタ範囲を形成することもできます。  <code>^</code> フラグはレジスタ・リスト・オペランドではエンコードされませんが、
命令ニーモニックに直接エンコードされます。 つまり、 <code>^ldm,</code> と <code>^stm,</code> を使用します。
</p>
<p>複数のロード/ストアのアドレッシング・モードは命令接尾辞としてエンコードされず、 代わりにアドレッシング・モードのように指定されます。
<code>DA</code>, <code>IA</code>, <code>DB</code>, <code>IB</code>, <code>DA!</code>, <code>IA!</code>,
<code>DB!</code>, <code>IB!</code> のいずれかを使います。
</p>
<p>以下の表にいくつかの例を示します:
</p>
<div class="example">
<pre class="example">Gforth                           normal assembler
r4 ia  { r0 r7 r8 }  stm,        stmia    r4, {r0,r7,r8}
r4 db!  { r0 r7 r8 }  ldm,       ldmdb    r4!, {r0,r7,r8}
sp ia!  { r0 r15 r-r }  ^ldm,    ldmfd    sp!, {r0-r15}^
</pre></div>

<p>Forth アセンブラに典型的な制御構造ワードが利用可能です: <code>if,</code>, <code>ahead,</code>, <code>then,</code>,
<code>else,</code>, <code>begin,</code>, <code>until,</code>, <code>again,</code>, <code>while,</code>,
<code>repeat,</code>, <code>repeat-until,</code> 。 条件は以下のワードの前に指定します:
</p>
<div class="example">
<pre class="example">r1 r2 cmp,    \ compare r1 and r2
eq if,        \ equal?
   ...          \ code executed if r1 == r2
then,
</pre></div>

<p>ARM アセンブラを使用した定義の例:
</p>
<div class="example">
<pre class="example">abi-code my+ ( n1 n2 --  n3 )
   \ arm abi: r0=SP, r1=&amp;FP, r2,r3,r12 saved by caller
   r0 IA!  { r2 r3 }  ldm,     \ pop r2 = n2, r3 = n1
   r3  r2  r3         add,     \ r3 = n1+n1
   r3  r0 -4 #]!      str,     \ push r3
   pc  lr             mov,     \ return to caller, new SP in r0
end-code
</pre></div>


</div>
<hr>
<div class="header">
<p>
Next: <a href="Other-assemblers.html">Other assemblers</a>, Previous: <a href="PowerPC-assembler.html">PowerPC assembler</a>, Up: <a href="Assembler-and-Code-Words.html">Assembler and Code Words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
