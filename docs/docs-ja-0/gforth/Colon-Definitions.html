<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- このマニュアルは、 標準 Forth 言語の高速で移植可能な実装である Gforth (バージョン 0.7.9_20240418,
April 18, 2024)用です。 これはリファレンス・マニュアルとして機能しますが、 Forth の概要と Forth
チュートリアルも含まれています。

Authors: Bernd Paysan, Anton Ertl, Gerald Wodni Copyright (C) 1995,
1996, 1997, 1998, 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
2011, 2012, 2013, 2014,2015,2016,2017,2018,2019,2020,2021,2022,2023 Free
Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.1 or any later
version published by the Free Software Foundation; with no Invariant
Sections, with the Front-Cover texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have freedom to copy and modify this
GNU Manual, like GNU software.  Copies published by the Free Software
Foundation raise funds for GNU development." -->
<title>Colon Definitions (Gforth マニュアル)</title>

<meta name="description" content="Colon Definitions (Gforth マニュアル)">
<meta name="keywords" content="Colon Definitions (Gforth マニュアル)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Word-Index.html" rel="index" title="Word Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Defining-Words.html" rel="up" title="Defining Words">
<link href="Anonymous-Definitions.html" rel="next" title="Anonymous Definitions">
<link href="Varues.html" rel="prev" title="Varues">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="gforth.css">


</head>

<body lang="en">
<div class="subsection" id="Colon-Definitions">
<div class="header">
<p>
Next: <a href="Anonymous-Definitions.html" accesskey="n" rel="next">Anonymous Definitions</a>, Previous: <a href="Varues.html" accesskey="p" rel="prev">Varues</a>, Up: <a href="Defining-Words.html" accesskey="u" rel="up">Defining Words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Colon-Definitions-2"></span><h4 class="subsection">6.10.6 Colon Definitions</h4>
<span id="index-colon-definitions"></span>

<div class="example">
<pre class="example">: name ( ... -- ... )
    word1 word2 word3 ;
</pre></div>

<p>Creates a word called <code>name</code> that, upon execution, executes <code>word1
word2 word3</code>. <code>name</code> is a <em>(colon) definition</em>.
</p>
<p>The explanation above is somewhat superficial. For simple examples of colon
definitions see <a href="Your-first-definition.html">Your first Forth definition</a>.  For an in-depth discussion of
some of the issues involved, See <a href="Interpretation-and-Compilation-Semantics.html">Interpretation and Compilation Semantics</a>.
</p>
<span id="index-_003a-_0028--_0022name_0022-_002d_002d-colon_002dsys--_0029-core"></span>
<span id="index-_003a"></span>
<div class="format">
<pre class="format"><code>:</code> ( <i>&quot;name&quot; &ndash; colon-sys  </i>) core &ldquo;colon&rdquo;
</pre></div>

<span id="index-_003b-_0028--compilation-colon_002dsys-_002d_002d-_003b-run_002dtime-nest_002dsys-_002d_002d--_0029-core"></span>
<span id="index-_003b"></span>
<span id="index-_003b-1"></span>
<div class="format">
<pre class="format"><code>;</code> ( <i>compilation colon-sys &ndash; ; run-time nest-sys &ndash;  </i>) core &ldquo;semicolon&rdquo;
</pre></div>


<p>We plan to to perform automatic inlining eventually, but for now you can
perform inlining with
</p>
<span id="index-inline_003a-_0028--_0022name_0022-_002d_002d-inline_003a_002dsys--_0029-gforth_002dexperimental"></span>
<span id="index-inline_003a"></span>
<span id="index-inline_003a-1"></span>
<div class="format">
<pre class="format"><code>inline:</code> ( <i>&quot;name&quot; &ndash; inline:-sys  </i>) gforth-experimental &ldquo;inline-colon&rdquo;
</pre></div>
<p>Start inline colon definition.  The code between <code>inline:</code> and
<code>;inline</code> has to compile (not perform) the code to be inlined, but the
resulting definition <i>name</i> is a colon definition that performs the
inlined code.  Note that the compiling code must have the stack effect
<code>( -- )</code>, otherwise you will get an error when Gforth tries to create
the colon definition for <i>name</i>.
</p>

<span id="index-_003binline-_0028--inline_003a_002dsys-_002d_002d--_0029-gforth_002dexperimental"></span>
<span id="index-_003binline"></span>
<span id="index-_003binline-1"></span>
<div class="format">
<pre class="format"><code>;inline</code> ( <i>inline:-sys &ndash;  </i>) gforth-experimental &ldquo;semi-inline&rdquo;
</pre></div>
<p>end inline definition started with <code>inline:</code>
</p>


<p>As an example, you can define an inlined word and use it with
</p>
<div class="example">
<pre class="example">inline: my2dup ( a b -- a b a b )
    ]] over over [[ ;inline

#1. my2dup d. d.
: foo my2dup ;
#1. foo d. d.
see foo
</pre></div>

<p>Inline words are related to macros (see <a href="Macros.html">Macros</a>); the difference is that
a macro has immediate compilation semantics while an <code>inline:</code>-defined
word has default compilation semantics; this means that you normally use a
macro only inside a colon definition, while you can use an <code>inline:</code>
word also interpretively.  But that also means that you can do some things
with macros that you cannot do as an <code>inline:</code> word.  E.g.,
</p>
<div class="example">
<pre class="example">\ Doesn't work:
\   inline: endif ]] then [[ ;inline
\ Instead, write a macro:
: endif ]] then [[ ; immediate
</pre></div>

<p>Conversely, for words that would be fine as non-immediate colon definitions,
define them as non-immediate colon definitions or (if utmost performance is
required) as <code>inline:</code> words; don&rsquo;t define them as macros, because then
you cannot properly use them interpretively:
</p>
<div class="example">
<pre class="example">: another2dup ]] over over [[ ; immediate
\ Doesn't work:
\   #1. another2dup d. d.
</pre></div>

<p>You may wonder why you have to write compiling code between <code>inline:</code>
and <code>;inline</code>.  That&rsquo;s because the implementation of an inline word
like <code>my2dup</code> above works similar to:
</p>
<div class="example">
<pre class="example">: compile-my2dup ( xt -- )
    drop ]] over over [[ ;

: my2dup [ 0 compile-my2dup ] ;
' compile-my2dup set-optimizer
</pre></div>

<p>The <code>DROP</code> and <code>0</code> are there because <code>compile-my2dup</code> is the
implementation of <code>compile,</code> for <code>my2dup</code>, and <code>compile,</code>
expects an xt (see <a href="User_002ddefined-compile_002dcomma.html">User-defined <code>compile,</code></a>).
</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Anonymous-Definitions.html">Anonymous Definitions</a>, Previous: <a href="Varues.html">Varues</a>, Up: <a href="Defining-Words.html">Defining Words</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Word-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
